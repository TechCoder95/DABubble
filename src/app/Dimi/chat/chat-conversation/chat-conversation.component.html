<main #scrollContainer>
  <div>
    @for(date of groupMessagesByDate() | keyvalue; track $index){
    @if(allMessages.length > 0){
    <section class="message-day">
      <p></p>
      <h4>{{ formatDateWithDay(date.key) }}</h4>
    </section>

    @for (message of allMessages; track $index) { @if($index > 0 &&
    message.senderId === allMessages[$index -1].senderId && message.senderName
    === this.activeUser.username){
    <app-send-chat-message
      [sendMessage]="message"
      [user]="activeUser"
      [isPrivate]="isPrivate"
      [index]="$index"
      [repeatedMessage]="true"
    ></app-send-chat-message>

    }@else if($index > 0 && message.senderId === allMessages[$index -1].senderId
    && message.senderName !== this.activeUser.username ){
    <app-receive-chat-message
      [receiveMessage]="message"
      [user]="activeUser"
      [isPrivate]="isPrivate"
      [repeatedMessage]="false"
    ></app-receive-chat-message>

    } @else if (message.senderName === this.activeUser.username) {
    <app-send-chat-message
      [sendMessage]="message"
      [user]="activeUser"
      [isPrivate]="isPrivate"
      [index]="$index"
      [repeatedMessage]="false"
    ></app-send-chat-message>
    }@else {
    <app-receive-chat-message
      [receiveMessage]="message"
      [user]="activeUser"
      [isPrivate]="isPrivate"
      [repeatedMessage]="false"
    ></app-receive-chat-message>
    } }}}
  </div>
</main>
